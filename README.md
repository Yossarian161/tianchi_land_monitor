# tianchi_land_monitor
天池大数据竞赛-土地智能监管

## 背景介绍
[题目介绍](https://tianchi.aliyun.com/competition/information.htm?raceId=231615)


# <center> 说明文档</center>

### 1 队伍简介

名次：第42名

队伍名：把球给我

队员全部来自中国科学院大学  


### 2 算法思路

首先手工标记第一阶段2015年和2017的图像里的建筑物，将大图像划分成小图像，训练多个模型，识别出图像中的建筑物，不对测试集（第二阶段的图像）进行任何标注，直接在图像上预测，分别识别出2015和2017的建筑物，再将所得的两张建筑物图像相减，即可得出最后的结果。

+ 切割成160\*160、224\*224、256\*256大小的小图片训练模型

+ 基于第一阶段的数据，分别训练了deeplabv2\_160、deeplabv2\_256、resnet\_224、resnet\_256 四个模型，最后的预测是4个模型的输出概率的均值，设定输出概率大于0.5判定为建筑物，小于0.5则为非建筑物

+ 对第一阶段的数据进行建筑物标注，预测结果线上可以达到0.84的分数，经过调参，分数最终达到0.89

+ 不对第二阶段的数据进行任何标注，直接进行预测，10.27第一次提交分数0.64左右，排名第6名。经过调参和数据增强以及数据后处理，分数最后能达到0.66

+ 数据增强用于模型训练阶段，数据后处理是对预测结果进行散点消除和边缘腐蚀，用到Python的OpenCV模块的erdoe函数，能提高1%

### 3 目录和文件说明

1. data\_160、data\_224、data\_256分别存放对应大小的图像
2. logs目录存放训练出的模型和验证集的图片预测输出，方便直接预览模型输出效果
3. labels目录存放手工标记的第一阶段的建筑物标签，将大图像切割成960\*960的小图像更清晰方便标记
4. label_image.py:脚本标记建筑物
5. utils.py:训练图像数据增广
6. HazeRemoval.py:图像去雾，消除原图像中云雾的干扰
6. data_process.py:数据预处理
7. resnet50.py、model.py:基于resnet的FCN模型
8. deeplabv2.py:deeplabv2模型
9. train.py:训练模型
10. evaluate.py:本地测试评测
11. inference.py:预测测试数据
12. data_process.ipynb:显示相关的中间结果，包括手工标记的建筑物图像，预测结果图像以及经过腐蚀的结果图像

**特别说明**：

为了提高效率，我们将各个阶段得到的中间数据保存下来，在需要的时候可以直接读取，因此代码不能完整运行，需要根据实际情况分步运行。

由于包含数据的源文件太大，不方便上传，因此删掉了图像数据，只保留了目录结构，方便理解。

1. 该目录下需要有各个阶段的原始图像数据，运行data_process.py文件，切分图像。如需完整运行，需要删除被代码中注释。
2. 根据需要修改data_process.py和train.py中的参数训练模型。
3. 当正确格式的测试数据生成之后，直接运行inference.py可以得到预测结果命名为submit.tiff。
 